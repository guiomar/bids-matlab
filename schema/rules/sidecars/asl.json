{
  "MRIASLTextOnly": {
    "selectors": [
      "datatype == \"perf\"",
      "intersects([suffix], [\"asl\", \"m0scan\"])"
    ],
    "fields": {
      "RepetitionTimePreparation": "required"
    }
  },
  "MRIASLCommonMetadataFields": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\""
    ],
    "fields": {
      "ArterialSpinLabelingType": "required",
      "PostLabelingDelay": "required",
      "BackgroundSuppression": "required",
      "M0Type": "required",
      "TotalAcquiredPairs": "required",
      "VascularCrushing": "recommended",
      "AcquisitionVoxelSize": "recommended",
      "LabelingOrientation": "recommended",
      "LabelingDistance": "recommended",
      "LabelingLocationDescription": "recommended",
      "LookLocker": "optional",
      "LabelingEfficiency": "optional"
    }
  },
  "MRIASLCommonMetadataFieldsM0TypeRec": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.M0Type != \"Estimate\""
    ],
    "fields": {
      "M0Estimate": {
        "level": "optional",
        "level_addendum": "required if `M0Type` is `Estimate`"
      }
    }
  },
  "MRIASLCommonMetadataFieldsM0TypeReq": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.M0Type == \"Estimate\""
    ],
    "fields": {
      "M0Estimate": {
        "level": "required",
        "issue": {
          "code": "M0ESTIMATE_NOT_DEFINED",
          "message": "You must define `M0Estimate` for this file, because `M0Type` is set to\n'Estimate'. `M0Estimate` is a single numerical whole-brain M0 value\n(referring to the M0 of blood), only if obtained externally (for example\nretrieved from CSF in a separate measurement).\n"
        }
      }
    }
  },
  "MRIASLCommonMetadataFieldsBackgroundSuppressionOpt": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.BackgroundSuppression == false"
    ],
    "fields": {
      "BackgroundSuppressionNumberPulses": {
        "level": "optional",
        "level_addendum": "recommended if `BackgroundSuppression` is `true`"
      },
      "BackgroundSuppressionPulseTime": {
        "level": "optional",
        "level_addendum": "recommended if `BackgroundSuppression` is `true`"
      }
    }
  },
  "MRIASLCommonMetadataFieldsBackgroundSuppressionReq": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.BackgroundSuppression == true"
    ],
    "fields": {
      "BackgroundSuppressionNumberPulses": "recommended",
      "BackgroundSuppressionPulseTime": "recommended"
    }
  },
  "MRIASLCommonMetadataFieldsVascularCrushingOpt": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.VascularCrushing == false"
    ],
    "fields": {
      "VascularCrushingVENC": {
        "level": "optional",
        "level_addendum": "recommended if `VascularCrushing` is `true`"
      }
    }
  },
  "MRIASLCommonMetadataFieldsVascularCrushingRec": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.VascularCrushing == true"
    ],
    "fields": {
      "VascularCrushingVENC": "recommended"
    }
  },
  "MRIASLCaslPcaslSpecific": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "intersects([sidecar.ArterialSpinLabelingType], [\"CASL\", \"PCASL\"])"
    ],
    "fields": {
      "LabelingDuration": "required",
      "LabelingPulseAverageGradient": "recommended",
      "LabelingPulseMaximumGradient": "recommended",
      "LabelingPulseAverageB1": "recommended",
      "LabelingPulseDuration": "recommended",
      "LabelingPulseFlipAngle": "recommended",
      "LabelingPulseInterval": "recommended"
    }
  },
  "MRIASLPcaslSpecific": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.ArterialSpinLabelingType == \"PCASL\""
    ],
    "fields": {
      "PCASLType": {
        "level": "recommended",
        "level_addendum": "if `ArterialSpinLabelingType` is `\"PCASL\"`"
      }
    }
  },
  "MRIASLCaslSpecific": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.ArterialSpinLabelingType == \"CASL\""
    ],
    "fields": {
      "CASLType": {
        "level": "recommended",
        "level_addendum": "if `ArterialSpinLabelingType` is `\"CASL\"`"
      }
    }
  },
  "MRIASLPaslSpecific": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.ArterialSpinLabelingType == \"PASL\""
    ],
    "fields": {
      "BolusCutOffFlag": "required",
      "PASLType": "recommended",
      "LabelingSlabThickness": "recommended"
    }
  },
  "MRIASLPASLSpecificBolusCutOffFlagFalse": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.ArterialSpinLabelingType == \"PASL\"",
      "sidecar.BolusCutOffFlag == false"
    ],
    "fields": {
      "BolusCutOffDelayTime": {
        "level": "optional",
        "level_addendum": "required if `BolusCutOffFlag` is `true`"
      },
      "BolusCutOffTechnique": {
        "level": "optional",
        "level_addendum": "required if `BolusCutOffFlag` is `true`"
      }
    }
  },
  "MRIASLPaslSpecificBolusCutOffFlagTrue": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"asl\"",
      "sidecar.ArterialSpinLabelingType == \"PASL\"",
      "sidecar.BolusCutOffFlag == true"
    ],
    "fields": {
      "BolusCutOffDelayTime": {
        "level": "required",
        "issue": {
          "code": "PASL_BOLUS_CUT_OFF_DELAY_TIME",
          "message": "It is required to define 'BolusCutOffDelayTime' for this file,\nwhen 'BolusCutOffFlag' is set to true. 'BolusCutOffDelayTime' is\nthe duration between the end of the labeling and the start of the\nbolus cut-off saturation pulse(s), in seconds. This can be a number\nor array of numbers, of which the values must be non-negative and\nmonotonically increasing, depending on the number of bolus cut-off\nsaturation pulses. For Q2TIPS, only the values for the first and last\nbolus cut-off saturation pulses are provided. Based on DICOM Tag\n0018,925F ASL Bolus Cut-off Delay Time.\n"
        }
      },
      "BolusCutOffTechnique": {
        "level": "required",
        "issue": {
          "code": "PASL_BOLUS_CUT_OFF_TECHINIQUE",
          "message": "It is required to define `BolusCutOffTechnique` for this file,\nwhen `BolusCutOffFlag` is set to `true`. `BolusCutOffTechnique`,\nis the name of the technique used\n(for example, Q2TIPS, QUIPSS or QUIPSSII).\nCorresponds to DICOM Tag 0018,925E `ASL Bolus Cut-off Technique`.\n"
        }
      }
    }
  },
  "MRIASLM0Scan": {
    "selectors": [
      "datatype == \"perf\"",
      "suffix == \"m0scan\""
    ],
    "fields": {
      "IntendedFor": {
        "level": "required",
        "description_addendum": "This is used to refer to the ASL time series for which the `*_m0scan.nii[.gz]` is intended.\n"
      },
      "AcquisitionVoxelSize": "recommended"
    }
  }
}